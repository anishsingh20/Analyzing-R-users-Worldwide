---
title: "Analyzing R users"
output:
  html_notebook: default
  pdf_document: default
---



## Overview

Stackoverflow recently released the anonymized results of their 2019 annual developer survey. The goal of this project is to analyse various trends for R developers worldwide.



First, let's filter all the R users from the dataset



```{r message=FALSE,warning=FALSE}

#reading necessary libraries
require(tidyverse)
require(countrycode)
require(highcharter)
require(ggplot2)

#reading the data
data <- read_csv("data/survey_results_public.csv")
attach(data)



RUsers<- data %>% 
  filter(grepl('^R$', LanguageWorkedWith) | grepl(';R$', LanguageWorkedWith) | 
           grepl(';R;', LanguageWorkedWith) | grepl('^R;', LanguageWorkedWith)) %>% 
  filter(MainBranch %in% c('I am a developer by profession', 
                           'I am not primarily a developer, but I write code sometimes as part of my work')) %>% 
  filter(Employment %in% c('Employed full-time', 
                           'Employed part-time', 
                           'Independent contractor, freelancer, or self-employed')) %>% 
  filter(!grepl('Other Country', Country)) %>% 
  filter(!is.na(Country), !is.na(ConvertedComp), ConvertedComp > 0) 


attach(RUsers)

```

Let's begin with *Uni-variate* analysis of variables, then slowly we can proceed with *bi-variate* and *multi-variate* analysis as well as soon as things start getting interesting.

### Let's start with the Profession of R Users


```{r message=FALSE,warning=FALSE}

table(MainBranch)


```

So we can notice that most of the R users were developers.


Let's check which country has the most R users


```{r message=FALSE,warning=FALSE}

RCountry <- RUsers %>% group_by(Country) %>% 
  select(Country) %>% 
  summarise(Count = n()) %>% 
  arrange(desc(Count)) %>% 
  top_n(20)

```

We can see that most R users are in US followed by Germany , UK then India.


#### Let's check what do R users professionaly do and their Employment as well: 


```{r message=FALSE, warning=FALSE}

table(MainBranch)
table(Employment)

```
So as we can notice, most of them are __developers__ followed by __students__ and most of them are employed as Full time employees.


### Let's now check the Education level of R users worldwide


```{r warning=FALSE,message=FALSE}

table(EdLevel)

```
So as we can see most of the R users hold  Master's degree followed by Bachelor's degree followed by doctoral degrees as well.

Let's also see the undergraduate degrees of the users.

```{r message=FALSE,warning=FALSE}

table(UndergradMajor)


```
Most of them hold a UG degree in CS and software engineering followed by mathematics and statistics.



### let's analyze educations level and UG for top countries


1) Let's start off with US

```{r warning=FALSE,message=FALSE}

USEduR <- RUsers %>% filter(Country=='United States') %>% 
                    select(EdLevel) %>% 
                    group_by(EdLevel) %>% 
                    summarise(CountEdu=n()) %>% 
                    arrange(desc(CountEdu))


# also doing the same to find the count of UG studies of R users in US
US_UG_R <- RUsers %>% filter(Country=='United States') %>% 
                    select(UndergradMajor) %>% 
                    group_by(UndergradMajor) %>% 
                    summarise(CountUG=n()) %>% 
                    arrange(desc(CountUG))


# Now let's plot them

hchart(USEduR,hcaes(x=USEduR$EdLevel,y=USEduR$CountEdu),type="column",color="purple",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Education of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

hchart(US_UG_R,hcaes(x=US_UG_R$UndergradMajor,y=US_UG_R$CountUG),type="column",color="yellow",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="UG majors of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
 

```


2) Let's check for India now:
```{r warning=FALSE,message=FALSE}
# EdLevel

IndiaEduR <- RUsers %>% filter(Country=='India') %>% 
                    select(EdLevel) %>% 
                    group_by(EdLevel) %>% 
                    summarise(CountEdu=n()) %>% 
                    arrange(desc(CountEdu))


# also doing the same to find the count of UG studies of R users in US
India_UG_R <- RUsers %>% filter(Country=='India') %>% 
                    select(UndergradMajor) %>% 
                    group_by(UndergradMajor) %>% 
                    summarise(CountUG=n()) %>% 
                    arrange(desc(CountUG))


# Now let's plot them

hchart(IndiaEduR,hcaes(x=IndiaEduR$EdLevel,y=IndiaEduR$CountEdu),type="column",color="green",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Education of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

hchart(India_UG_R,hcaes(x=India_UG_R$UndergradMajor,y=India_UG_R$CountUG),type="column",color="orange",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="UG majors of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
 

```


3)Let's check for UK:
```{r warning=FALSE,message=FALSE}
USEduR <- RUsers %>% filter(Country=='United States') %>% 
                    select(EdLevel) %>% 
                    group_by(EdLevel) %>% 
                    summarise(CountEdu=n()) %>% 
                    arrange(desc(CountEdu))


# also doing the same to find the count of UG studies of R users in US
US_UG_R <- RUsers %>% filter(Country=='United States') %>% 
                    select(UndergradMajor) %>% 
                    group_by(UndergradMajor) %>% 
                    summarise(CountUG=n()) %>% 
                    arrange(desc(CountUG))


# Now let's plot them

hchart(USEduR,hcaes(x=USEduR$EdLevel,y=USEduR$CountEdu),type="column",color="purple",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Education of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

hchart(US_UG_R,hcaes(x=US_UG_R$UndergradMajor,y=US_UG_R$CountUG),type="column",color="yellow",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="UG majors of R users in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
 
```