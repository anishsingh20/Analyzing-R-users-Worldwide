---
title: "Analyzing R user Trends"
output:
  html_notebook: default
  pdf_document: default
---

## Overview

Stackoverflow recently released the anonymized results of their 2019 annual developer survey. The goal of this project is to analyse various trends for R users and developers worldwide.



#### Data Wrangling 

The dataset has 90,000 rows. Our goal is to filter R responses so that we can drill down further and analyze the trends related to R developers.

```{r message=FALSE, warning=FALSE}

#reading necessary libraries
require(tidyverse)
require(countrycode)
require(highcharter)
require(ggplot2)

#reading the data
data <- read_csv("data/survey_results_public.csv")
attach(data)

#Let's check who all are developers
devTable <- as.data.frame(table(data$MainBranch))


```

Let's create a braplot of the profession of the respondents.

```{r message=FALSE, warning=FALSE}

hchart(devTable,hcaes(x=Var1,y=Freq),type="column",name="Count",color="#9B6ED8") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot of occupation of participants",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 


```

So we can notice that that most of the participants are <b>developers</b>.


Now let's see how many developers have developement just as a hobby.
```{r message=FALSE, warning=FALSE} 

table(data$Hobbyist)
table(OpenSourcer)

```


Let's check the Employment of the respondents.

```{r message=FALSE, warning=FALSE}

round(prop.table(table(Employment))*100,2)

```
We can notice that 74 % of the respondents were ***Full time employees***.


Now let's check to which country the respondents belonged.

```{r message=FALSE,warning=FALSE}

#Creating a data frame of the Country and its frequency.
countryDf <- data %>% count(Country) %>% 
  top_n(10)

#arranging in descending order of count
countryDf<-arrange(countryDf,desc(n))
  
hchart(countryDf,hcaes(x=Country,y=n),type="column",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot of Country of respondents",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

```
From the above plot we can notice that most of the respondents were from US,India followed by Germany.

```{r message=FALSE,warning=FALSE}
table(Student)

```
We can notice that most of the respondents are not Students.


### Let's see which country had most respondents as Students ?

To achieve this let's create a Dataframe of countries with highest number of Student respondents.

```{r message=FALSE,warning=FALSE}

StudentDf <- data %>% filter(Student=="Yes, full-time") %>% 
  count(Country) %>% 
  top_n(30) %>% 
  arrange(desc(n))

StudentDf


```
So most of the Students were from __India__,not from US.


Let's check the Education level for the major countries like India and US.
```{r message=FALSE,warning=FALSE}


EdlevelIndia<- data %>% filter(Country == "India") %>% 
  group_by(EdLevel) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

#ignoring NA values
EdlevelIndia <- na.omit(EdlevelIndia)
  
#let's create a Barplot
hchart(EdlevelIndia,hcaes(x=EdlevelIndia$EdLevel,y=EdlevelIndia$count),type="column",color="red",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot Education level of Indian Respondents",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 


  
  



```
Let's check the results for USA.


```{r message=FALSE, warning=FALSE}

EdlevelUS<- data %>% filter(Country == "United States") %>% 
  group_by(EdLevel) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

#ignoring NA values
EdlevelIndia <- na.omit(EdlevelIndia)

# let's create a Barplot
hchart(EdlevelUS,hcaes(x=EdlevelUS$EdLevel,y=EdlevelUS$count),type="column",color="Green",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot Education level of American Respondents",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
  
```


Let's check the results for Germany.

```{r}

Edlevelger<- data %>% filter(Country == "Germany") %>% 
  group_by(EdLevel) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

#let's create a Barplot
hchart(Edlevelger,hcaes(x=Edlevelger$EdLevel,y=Edlevelger$count),type="column",color="purple",name="Count") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot Education level of german Respondents",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 
```

### Let's analyze the UnderGraduate majors of the Participants


```{r message=FALSE,warning=FALSE}

table(UndergradMajor)

```

As expected most of them are __Computer Science Graduates followed by Another Engineering disclipine and Information Systems__.



Country and the under-graduate programmes in which the participants were enrolled.


```{r warning=FALSE,message=FALSE}

#for India
UGIndia<- data %>% filter(Country == "India") %>% 
  group_by(UndergradMajor) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

UGIndia<-na.omit(UGIndia)

UGIndia

#for US
UGUS<- data %>% filter(Country == "United States") %>% 
  group_by(UndergradMajor) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

UGUS<-na.omit(UGUS)

UGUS

#for Germany
UGGermany<- data %>% filter(Country == "Germany") %>% 
  group_by(UndergradMajor) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))

UGGermany<-na.omit(UGGermany)

UGGermany

```

We see almost similar trends for all the 3 major countries.


### Let's see what type of developers were there ?


```{r warning=FALSE,message=FALSE}

#keeping only the respondents from top 10 countries.
DevTypeDf<- data %>% filter(Country %in% countryDf$Country) %>% 
  select(DevType) %>% 
  group_by(DevType) %>% 
  #creating a new column which has the count
  summarise(Count = n()) %>% 
  filter(Count > 100) %>% 
  arrange(desc(Count))

DevTypeDf<-na.omit(DevTypeDf)

DevTypeDf



```

So most of the respondents from the top 10 countries were __Full stack developers__ and __backend developers__.


### Let's check if Indian,American and German respondents had what job ?


```{r warning=FALSE,message=FALSE}

DevIndia<- data %>% filter(Country == "India") %>% 
  select(DevType) %>% 
  group_by(DevType) %>% 
  summarise(Count=n()) %>% 
  arrange(desc(Count)) %>% 
  top_n(10)


DevUs<- data %>% filter(Country == "United States") %>% 
  select(DevType) %>% 
  group_by(DevType) %>% 
  summarise(Count=n()) %>% 
  arrange(desc(Count)) %>% 
  top_n(10)



DevGer<- data %>% filter(Country == "Germany") %>% 
  select(DevType) %>% 
  group_by(DevType) %>% 
  summarise(Count=n()) %>% 
  arrange(desc(Count)) %>% 
  top_n(10)

DevGer<- data %>% filter(Country == "Germany") %>% 
  select(DevType) %>% 
  group_by(DevType) %>% 
  summarise(Count=n()) %>% 
  arrange(desc(Count)) %>% 
  top_n(10)


```





Creating the Plot: 



```{r warning=FALSE,message=FALSE}

  
hchart(DevIndia,hcaes(x=DevIndia$DevType,y=DevIndia$Count),type="column") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot of top developers in India",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

hchart(DevUs,hcaes(x=DevUs$DevType,y=DevUs$Count),type="column") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot of top developers in US",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 


hchart(DevGer,hcaes(x=DevGer$DevType,y=DevGer$Count),type="column") %>%  
  hc_exporting(enabled = TRUE) %>%
  hc_title(text="Barplot of top developers in Germany",align="center") %>%
  hc_add_theme(hc_theme_elementary()) 

```




### Let's check the Job satisfaction of the Respondents:

This is a really interesting feature to analyze. We can analyze which specific Job roles were most satisfied or in the list of top 10 countries how many respondents were satisfied with their Jobs etc.

```{r warning=FALSE,message=FALSE}

table(JobSat)



```



#### We can also analyze the Job Factors 
